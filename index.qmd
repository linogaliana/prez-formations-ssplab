---
title: "Statistique publique et _big data_"
subtitle: |
  Quelques applications
date: "14-05-2024"
author:
    - name: "**[[Lino Galiana](https://www.linogaliana.fr/)]{.blue2}**"
      email: lino.galiana@insee.fr
      affiliations:
        - name: "[__Insee__]{.orange}"
#date: 06-09-2023
slide-number: true
footer: |
  **S√©minaire big data, ENSAI**
# uncomment for French presentations:
lang: fr-FR
# for blind readers:
slide-tone: false
# for @olevitt:
#chalkboard: # press the B key to toggle chalkboard
#  theme: whiteboard
# uncomment to use the multiplex mode:
#multiplex: true
format:
  # pick the light mode (onyxia-revealjs) or the dark mode (onyxia-dark-revealjs)
  onyxia-revealjs
  #onyxia-dark-revealjs:
    #output-file: slides.html
from: markdown+emoji
css: custom.css
---

# Introduction

## Contexte

- Baisse du co√ªt de stockage et du co√ªt du traitement ; 

. . .

- Co√ªts fixes importants mais co√ªts marginaux nuls:
    + Int√©r√™t √† accumuler la donn√©e ;

. . .

- Collecte en temps r√©el et processus √©volutif (NoSQL)

::: {.callout-warning}
[_"Big data is dead"_](https://motherduck.com/blog/big-data-is-dead/): la valeur de la donn√©e _big data_ est tr√®s li√©e √† sa fraicheur
:::



## Big data et statistique publique

<h3>Avantages</h3>

- Haute fr√©quence temporelle

. . .

- Finesse g√©ographique

. . .

- Automatisation de la collecte permet une exhaustivit√©



## Big data et statistique publique

<h3>D√©fis</h3>

- Donn√©e transactionnelle
    + Pas construite pour la statistique publique

. . .

- Continuit√©, au niveau de l‚Äôunit√© statistique, ne va pas de soi

. . .

- Beaucoup de similarit√© avec donn√©es administratives:
    + Diff√©rence principale: la population cible n'est pas connue


## Quelques exemples de _big data_ dans la stat publique

- [Syst√®me national des donn√©es de sant√© (SNDS)](https://www.snds.gouv.fr/SNDS/Accueil) ;
- [D√©claration sociale nominative (DSN)](https://entreprendre.service-public.fr/vosdroits/F34059#:~:text=De%20quoi%20s%27agit%2Dil,partir%20du%20logiciel%20de%20paie.) ;
- [SIVIC](https://esante.gouv.fr/SI-VIC) et [SIDEP](https://www.cnil.fr/fr/cnil-direct/question/passe-sanitaire-sidep-cest-quoi)
- [Donn√©es de caisse](https://www.insee.fr/fr/metadonnees/definition/c2159)
- ...

# Plan

1. Donn√©es de caisse: classification automatique ; 
2. Donn√©es de caisse: appariement √† un r√©f√©rentiel de produits ; 
3. Le projet RESIL: appariement √† un r√©f√©rentiel de personnes ; 


# Donn√©es de caisse

## Contexte

<br>

- __Depuis 2020__
    + üõí Utilisation des [donn√©es de caisses](https://www.insee.fr/fr/metadonnees/definition/c2159) dans le calcul de [l‚ÄôIPC](https://www.insee.fr/fr/metadonnees/source/indicateur/p1653/description) (contexte: [Leclair, 2019](https://www.insee.fr/fr/information/4254225?sommaire=4254170))

. . .

- __Contenu des donn√©es__ üì¶
    + Br√®ve description du produit
    + Prix & Quantit√©s vendues => Chiffre d'affaires
    + [Code EAN](https://fr.wikipedia.org/wiki/Code-barres_EAN)

## Exemple fictif des donn√©es utilis√©es

<br>

| Description   | EAN | CA (‚Ç¨)         | Enseigne | Date |
|------------------|----------|--------------|----------|------------|
| Lait demi-√©cr√©m√© | 67890123 |   1500         | √âcoShop | 15-01-23 |
| Pain complet     | 43210123 |   12000        | PrixMini | 18-02-23 |

## Avantages des donn√©es de caisses

<br>

- __(Quasi-)Exhaustivit√©__ üìö
    + Couverture importante du march√© de la grande distribution
  
. . .

- __Pr√©cision__ üéØ
    + Am√©lioration des indices existants

. . . 

- __Innovations potentielles__ üìà 
    + Indices r√©gionaux
    + Comparaisons spatiales des prix

## La Coicop

<br>

- Pour la __production__ de l'IPC, les articles doivent √™tre class√©s dans la [nomenclature Coicop](https://www.insee.fr/fr/information/2402696)

![](img/exemple_poste.png)


## Probl√®me

Besoin d'un algorithme de classification pour pallier l'incompl√©tude du r√©f√©rentiel

![](img/graph_ddc.png)

## `FastText`

<br>

- Librairie fr√©quemment utilis√©e dans les projets de codification automatique de l‚ÄôInsee ;

. . . 

- D√©velopp√©e par Meta, [_open source_](https://fasttext.cc/)

. . .

- Ligne de commande et API `Python`

## Avantages ü•á

<br>

* Faible utilisation des ressources ;

. . .

* Rapidit√© d'entra√Ænement ;

. . .

* Bonnes performances en classification supervis√©e ;

. . .

* Peu exigeante en termes d'infrastructure ;

. . .

* Fournit une m√©trique de confiance pour chaque pr√©diction

## Inconv√©nients üò®

<br>

* Peu maintenue ;

. . .

* Documentation perfectible ;

. . .

* R√©entrainement _from scratch_ √† chaque projet ;


## Performance

- Entra√Ænement et tests sur des enseignes repr√©sentant environ 20% des donn√©es √©tiquet√©es ;

- [Pr√©cision/rappel](https://fr.wikipedia.org/wiki/Pr%C3%A9cision_et_rappel) √©quivalents ‚âà 97 % ;

. . .

- Un peu meilleur sur les produits de grande consommation
    + Pr√©dictions correctes ‚âà 98 % du CA ‚úÖ


# Appariements √† des donn√©es de caisse

## Probl√©matique

Enrichissement de donn√©es de caisse avec plusieurs sources d'information
√† l'aide de [__m√©thodes avanc√©es d'appariement flou__]{.blue2}
:: :

- Utiliser √† la fois [l'approche du moteur de recherche]{.orange} (`ElasticSearch`) et les [embeddings]{.orange} pour associer les paires.
- Proc√©dure visant √† minimiser les [faux positifs]{.orange}.

::: {.callout-note}
Plus de d√©tails dans [Galiana & Suarez-Castillo (2022)](https://dl.acm.org/doi/abs/10.1145/3524458.3547244)
:::


# Sources

## Donn√©es de scanner ([`Relevanc`](https://www.groupe-casino.fr/en/group/activities/e-commerce-new-business-activities/relevanc/) donn√©es) {.smaller}

- [__Groupe Casino__]{.orange} (>10% du march√© fran√ßais):
    - Environ [11 000]{.orange} supermarch√©s ;
    - Environ [250 000]{.orange} produits diff√©rents ;
    - Les revenus des supermarch√©s et les niveaux de cartes de fid√©lit√© sont tous deux √©lev√©s. <br><br>

- Pas les m√™mes donn√©es que celles de l'IPC !

:::{.callout-tip}

- Besoin d'√™tre enrichi pour l'analyse :
    - [G√©ocodage des supermarch√©s]{.moyen} ;
    - [__Obtention des caract√©ristiques des produits__]{.green2}.

:::

## Donn√©es nutritionnelles crowdsourc√©es ([`Open Food Facts`](https://fr.openfoodfacts.org/)) 

- Environ [2 millions de produits]{.orange} (mise √† jour continue)

. . .

| Type d'information | Exemples |
|------------|-------------|
| Indices de qualit√© agr√©g√©s | `Nutriscore`, score `NOVA`, `Ecoscore`... |
| Informations nutritionnelles | √ânergie, glucides, mati√®res grasses... |
| Informations sur le produit | Emballage, volume... |

## Importance du _preprocessing_ 1/2 {.smaller}

1. [R√©duire le bruit]{.orange} dans le jeu de donn√©es ;
1. [Harmoniser]{.orange} diff√©rentes sources ;
1. [Identifier les produits non alimentaires]{.orange} malgr√© le filtrage des cat√©gories.

::: {layout-ncol=2}
![Donn√©es de scanner (`RelevanC`)](img/wordcloud_relevanc_start.png)



![Donn√©es nutritionnelles crowdsourc√©es (`Open Food Facts`)](img/wordcloud_openfood_start.png)
:::

## Importance du _preprocessing_ 2/2 {.smaller}

<input type="checkbox" checked> [R√©duire le bruit]{.orange} dans le jeu de donn√©es ;  </input><br>
<input type="checkbox" checked> [Harmoniser]{.orange} diff√©rentes sources ;  </input><br>
<input type="checkbox" checked> [Identifier les produits non alimentaires]{.orange} malgr√© le filtrage des cat√©gories.</input>

::: {layout-ncol=2}
![Donn√©es de scanner (`RelevanC`)](img/wordcloud_relevanc_clean.png)

![Donn√©es nutritionnelles crowdsourc√©es (`Open Food Facts`)](img/wordcloud_openfood_clean.png)
:::


# L'enjeu de l'appariement flou

- Probl√®me des appariements flous par distance textuelle: les synonymes
    - Beaucoup d'alcools (Ricard & Pastis...)
- Un dictionnaire de conversion construit en scrapant _Wikipedia_
- Mais pour aller plus loin, besoin d'un mod√®le de reconnaissance des synonymes
    - Entra√Ænement par la technique des r√©seaux de neurones siamois

![Siamese Neural Network](img/siamese_animal.png)


# Deux approches compl√©mentaires pour les appariements flous

- Construction d'un algorithme d'appariement en 5 √©tapes :
    - Du plus fiable (appariement EAN) au moins fiable (appariement flou sur des cat√©gories g√©n√©riques depuis base CIQUAL)
    - Validation/rejet par un _mix_ distances textuelles et s√©mantiques

![](img/header_relevanc.png)

# R√©sultats sur les enrichissements

- Environ 90% des magasins g√©olocalis√©s et identifi√©s par SIRET
- Environ 98% des produits enrichis avec des caract√©ristiques gr√¢ce √† OpenFoodFacts ou CIQUAL
    - Pr√®s de la moiti√© par appariements flous
- Plus d'infos sur l'enrichissement des produits dans [Galiana & Suarez-Castillo (2022)](https://dl.acm.org/doi/abs/10.1145/3524458.3547244)
